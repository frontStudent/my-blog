
### 解耦&削峰
- 解耦
- 削峰: 当大量用户同时请求时，请求先进入消息队列。系统可以按照自己的处理能力从消息队列中逐步取出请求进行处理。

### 消息消费方式
- Pull 拉取模式: 消费者主动从消息队列中拉取消息
优点: 消费者可以根据自己的处理能力和资源状况，灵活地调整拉取消息的频率和数量，避免过载；缺点是实时性相对差
- Push 推送模式: 消息队列主动将消息推送给消费者
优点: 实时性好，消费者可以及时接收到消息；缺点是消费者需要处理大量的消息，可能会导致过载

### 消息不丢失
- 生产者投放消息时不丢失
- 消费者消费消息时不丢失
- 消息队列存储消息时不丢失

前两种情况都是使用ack机制 只能保证消息不丢失，不能保证消息不重复消费。所以下游的消费者需要保证幂等性。
#### 幂等性
在计算机科学中，幂等性是指一个操作无论被执行多少次，产生的效果与只执行一次是相同的。
比如在电商系统中，用户下单成功后，系统可能会发送多个确认订单的请求到订单处理服务。如果订单处理服务的确认订单操作是幂等的，那么多次处理同一个订单的确认请求不会导致订单状态被错误地改变或产生重复的订单记录。

### 幂等策略
因为不同的 Message ID 对应的消息内容可能相同，有可能出现冲突（重复）的情况，所以真正安全的幂等处理，不建议以 Message ID 作为处理依据，最好的方式是以业务唯一标识作为幂等处理的关键依据，消息必须携带业务唯一标识。

参考：https://www.cnblogs.com/makemylife/p/17910944.html
